# Добро пожаловать в vulnerable standoff application

## Введение
Добро пожаловать в репозиторий проекта vuln_server! Этот проект направлен на оттачивание навыков пентестинга веб-приложений. Так же он может применяться при собеседовании на позицию junior-pentester для оценки навыков.

## Сюжет
Недавно УК City разработало приложение “Активный человек”, которое позволит властям и горожанам эффективнее контактировать друг с другом. Приложение позволяет гражданам выбирать инфраструктурные проекты для реализации в своем городе. Сегодня утром граждане увидели провокационные надписи в новом приложении, а в сети появились данные о продаже архива с данными жителей города. Глава УК City заявил прессе, что все данные были защищены с помощью шифрования, однако граждане опасаются за свою конфиденциальность. Началось расследование.

## Уязвимости
В рамках нашего проекта были исследованы следующие уязвимости:

- **A03:2021 – Injection (SQL injection)**: Это тип атаки на базы данных, при котором злоумышленник вводит вредоносный SQL-код в поля ввода, чтобы манипулировать запросами к базе данных. Это может привести к несанкционированному доступу, утечке данных, изменению или удалению информации
- **A07:2021 – Identification and Authentication Failures (IDOR)**: Уязвимость, связанная с небезопасной ссылкой на объект
- **A03:2021 – Injection (RCE via PDF creation)**: Уязвимость, связанная с небезопасной генерацией pdf-документов
- **A02:2021 – Cryptographic Failures**: Уязвимость, связанная с ненадежным шифрованием zip архива

## Технологии
В приложении использовались следующие технологии:
- **Json Web Token** для авторизации
- **SQLite** для хранения информации
- **Flask** для создания веб-приложения
- **Docker** для контейниризации приложения
- **LaTeX** для генерации документов

## Запуск
С использованием docker:
Скачайте проект, откройте терминал в корневой папке проекта и напишите команды "docker build -t <tag_name> . ", "docker run -d -p 5000:5000 --name <container_name> <tag_name>". Для взаимодействия с приложением перейдите по ссылке http://localhost:5000/
C использование Idle:
Запустите файл main.py, убедившись в том, что все библиотеки из requirements.txt установлены в виртуальном окружении.

## Прохождение
<details>
  <summary>Нажмите, чтобы открыть меню</summary>
  - Заходим на сайт, оцениваем функциональность.
  - Регистрируемся.
  - Видим, что мы можем поставить лайк, а также подтвердить аккаунт. На этом этапе эксплуатируем or-based SQL-injection [тык](https://book.hacktricks.xyz/pentesting-web/sql-injection) и [тык](https://www.google.com/url?sa=t&source=web&rct=j&opi=89978449&url=https://portswigger.net/web-security/sql-injection/cheat-sheet&ved=2ahUKEwjlq6yxgOmIAxVDFBAIHf9XFwgQFnoECBcQAQ&usg=AOvVaw1-chxB0XFPiDFl3H0x7eal)
  - После подтверждения аккаунта нам становится доступен вход по QR. Декодируем его и видим, что для входа, используется токен и id пользователя. Меняем id на id админа.
  - Оцениваем функциональность, которая доступна админу. Видим, что мы можем закрыть проект, однако, нам нехватает голосов граждан. Проведя фаззинг, видим, что данный эндпоинт также поддерживает метод POST. Далее подбираем параметр (helper), который нужно передать, чтобы обойти проверку на голоса (True)
  - Оцениваем функциональность, закрываем проект и получаем сгенерированный pdf-документ. Используя Exiftool определяем, что при генерировании использовался пакет LaTeX. 
  - Получаем доступ к функциональности пригласить друга. Так как на этапе разведки можно заметить, что используется flask, а также значение test_user отображается на странице, пробуем протестировать сайт на наличие SSTI с помощью {{7*7}}.
  - Используем payloads для получения reverse shell. Задание выполнено!
</details>

## Заключение
Призываю сообщество помочь в улучшении моего приложения. Если будут идеи, пожалуйста, создайте Issue или отправьте Pull Request.

Спасибо за интерес к проекту!
